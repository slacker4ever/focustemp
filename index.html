<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Focus Pet ‚Äî Local</title>

<!-- Font + Libraries -->
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --bg: linear-gradient(180deg, #073c35, #0a4540 40%, #05343a);
  --card: rgba(255,255,255,0.05);
  --muted: #b9d6d1;
  --accent1: #8de0c7;
  --accent2: #c3b4ff;
  --shadow: 0 8px 25px rgba(0,0,0,0.4);
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:'Fredoka',system-ui;
  background:var(--bg);
  color:#eaf9f4;
  overflow-x:hidden;
}
.app{max-width:920px;margin:10px auto;padding:14px;display:flex;flex-direction:column;gap:16px;}
header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
.brand{display:flex;align-items:center;gap:10px;}
.logo{width:42px;height:42px;border-radius:10px;background:linear-gradient(90deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;}
h1{font-size:1rem;margin:0;}
.top-cards{display:flex;gap:12px;align-items:center;}
.card-mini{background:var(--card);padding:10px 14px;border-radius:12px;box-shadow:var(--shadow);min-width:110px;text-align:center;}
.label{font-size:0.8rem;color:var(--muted);}
.val{font-weight:700;font-size:1.05rem;margin-top:6px;}

.focus-area{
  display:flex;flex-direction:column;align-items:center;
  background:rgba(255,255,255,0.02);
  border-radius:18px;
  padding:18px;
  box-shadow:var(--shadow);
}
.timer-card{
  width:320px;height:320px;border-radius:50%;
  background:rgba(255,255,255,0.03);
  position:relative;display:flex;align-items:center;justify-content:center;
}
.pet-top{position:absolute;top:10%;left:50%;transform:translateX(-50%);}
lottie-player{width:150px;height:150px;}
.timer-inner{position:absolute;bottom:15%;left:50%;transform:translateX(-50%);text-align:center;}
#time{font-size:2.4rem;font-weight:700;}
#petStatus{color:var(--muted);font-size:0.9rem;margin-top:4px;}

.controls{display:flex;gap:12px;margin-top:16px;}
button.control{
  background:var(--accent1);
  border:none;
  color:#053;
  padding:10px 18px;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  min-width:88px;
  box-shadow:var(--shadow);
}

.center-wrap{display:flex;flex-wrap:wrap;justify-content:center;align-items:flex-start;gap:24px;margin-top:10px;}
.side-panel{width:100%;max-width:360px;display:flex;flex-direction:column;gap:16px;}
.panel{background:var(--card);border-radius:14px;padding:14px;box-shadow:var(--shadow);}
.shop-grid{display:flex;flex-wrap:wrap;gap:10px;}
.shop-item{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;width:calc(50% - 6px);text-align:center;}
.shop-item button{margin-top:6px;padding:8px;border-radius:8px;border:none;background:var(--accent1);color:#053;cursor:pointer;font-weight:700;}

.charts{display:flex;flex-direction:column;align-items:center;gap:8px;margin-top:10px;}
.period-tabs{display:flex;gap:8px;justify-content:center;margin-bottom:8px;flex-wrap:wrap;}
.tab{padding:8px 12px;border-radius:999px;background:transparent;border:1px solid rgba(255,255,255,0.08);cursor:pointer;color:#d6f6ee;}
.tab.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#052;font-weight:700;}
#weeklyAvgContainer{display:flex;justify-content:space-between;width:100%;max-width:300px;color:var(--muted);font-size:0.9rem;margin-top:6px;margin-bottom:24px;}

@media(max-width:920px){.center-wrap{flex-direction:column;align-items:center}.side-panel{max-width:100%}}
</style>
</head>
<body>
<div class="app">
<header>
  <div class="brand">
    <div class="logo">üêæ</div>
    <div>
      <h1>Focus Pet</h1>
      <div style="font-size:0.9rem;color:var(--muted)">Raise your pet by focusing!</div>
    </div>
  </div>
  <div class="top-cards">
    <div class="card-mini">
      <div class="label">Total Focus Time</div>
      <div class="val" id="totalFocusVal">0 m</div>
    </div>
    <div class="card-mini">
      <div class="label">Coins</div>
      <div class="val" id="coinCount">0</div>
    </div>
  </div>
</header>

<main class="center-wrap">
<section class="focus-area">
  <div class="timer-card">
    <div class="pet-top">
      <lottie-player id="petAnim" src="Cat Pookie.json" background="transparent" speed="1" loop autoplay></lottie-player>
    </div>
    <div class="timer-inner">
      <div id="time">00:00</div>
      <div id="petStatus">Your pet is sleepy...</div>
    </div>
    <svg width="100%" height="100%" viewBox="0 0 320 320" preserveAspectRatio="xMidYMid meet" style="position:absolute;left:0;top:0;pointer-events:none">
      <defs><linearGradient id="g1"><stop offset="0" stop-color="#8de0c7"/><stop offset="1" stop-color="#c3b4ff"/></linearGradient></defs>
      <circle cx="160" cy="160" r="140" stroke="rgba(255,255,255,0.03)" stroke-width="12" fill="none"></circle>
      <circle id="ring" cx="160" cy="160" r="140" stroke="url(#g1)" stroke-width="12" fill="none" stroke-linecap="round" transform="rotate(-90 160 160)"></circle>
    </svg>
  </div>
  <div class="controls">
    <button class="control" id="startBtn">Start</button>
    <button class="control" id="pauseBtn">Pause</button>
    <button class="control" id="resetBtn">Reset</button>
  </div>
</section>

<aside class="side-panel">
  <div class="panel">
    <h3>Shop</h3>
    <div class="shop-grid">
      <div class="shop-item">üçñ Feed<br><strong>10 coins</strong><button id="feedBtn">Buy</button></div>
      <div class="shop-item">üß∏ Play<br><strong>15 coins</strong><button id="playBtn">Buy</button></div>
      <div class="shop-item">üåà Skin<br><strong>50 coins</strong><button id="skinBtn">Buy</button></div>
      <div class="shop-item">‚ú® Boost<br><strong>6 coins</strong><button id="boostBtn">Buy</button></div>
    </div>
  </div>

  <div class="panel">
    <h3>Progress</h3>
    <div class="period-tabs">
      <button class="tab active" data-period="daily">Daily</button>
      <button class="tab" data-period="weekly">Weekly</button>
      <button class="tab" data-period="monthly">Monthly</button>
      <button class="tab" data-period="yearly">Yearly</button>
    </div>
    <div class="charts">
      <canvas id="barChart" width="320" height="180"></canvas>
      <div id="weeklyAvgContainer"><span>Weekly average</span><span id="weeklyAvg">0 min</span></div>
    </div>
  </div>
</aside>
</main>
</div>

<script>
const LS_COINS='fp_coins',LS_SESS='fp_sessions';
let secs=0,timer=null,isRun=false,startISO=null;
let coins=parseInt(localStorage.getItem(LS_COINS)||'0',10)||0;
let sess=JSON.parse(localStorage.getItem(LS_SESS)||'[]');
const timeEl=document.getElementById('time'),coinEl=document.getElementById('coinCount'),pet=document.getElementById('petAnim'),status=document.getElementById('petStatus');
const totalVal=document.getElementById('totalFocusVal'),ring=document.getElementById('ring');
const R=140,C=2*Math.PI*R;ring.style.strokeDasharray=C;ring.style.strokeDashoffset=C;
function fmt(s){const m=Math.floor(s/60).toString().padStart(2,'0');const ss=(s%60).toString().padStart(2,'0');return`${m}:${ss}`;}
function fmtHM(t){const h=Math.floor(t/3600),m=Math.floor((t%3600)/60);return h>0?`${h} h ${m} m`:`${m} m`;}
function totalSecs(){return sess.reduce((a,b)=>a+b.secs,0)+secs;}
function updDisp(){timeEl.textContent=fmt(secs);ring.style.strokeDashoffset=C-(secs%60)/60*C;coinEl.textContent=coins;totalVal.textContent=fmtHM(totalSecs());updPet();}
function updPet(){if(!pet)return;if(secs<30){pet.setSpeed(0.6);status.textContent="Your pet is sleepy...";}else if(secs<60){pet.setSpeed(1);status.textContent="Your pet is waking up!";}else{pet.setSpeed(1.5);status.textContent="Your pet is super happy!";}}
function startT(){if(isRun)return;isRun=true;if(!startISO)startISO=new Date().toISOString();timer=setInterval(()=>{secs++;if(secs%10===0){coins++;localStorage.setItem(LS_COINS,coins);}updDisp();},1000);}
function pauseT(){if(!isRun)return;isRun=false;clearInterval(timer);timer=null;updDisp();}
function resetT(){if(secs>0&&startISO){sess.push({startISO,secs});localStorage.setItem(LS_SESS,JSON.stringify(sess));}
secs=0;startISO=null;isRun=false;clearInterval(timer);timer=null;updDisp();drawChart();}
document.getElementById('startBtn').onclick=startT;document.getElementById('pauseBtn').onclick=pauseT;document.getElementById('resetBtn').onclick=resetT;
function react(spd,txt){if(!pet)return;pet.setSpeed(spd);status.textContent=txt;setTimeout(()=>updPet(),3000);}
document.getElementById('feedBtn').onclick=()=>{if(coins>=10){coins-=10;localStorage.setItem(LS_COINS,coins);updDisp();react(2,'Yummy!');}else alert('Not enough coins');};
document.getElementById('playBtn').onclick=()=>{if(coins>=15){coins-=15;localStorage.setItem(LS_COINS,coins);updDisp();react(2.4,'Having fun!');}else alert('Not enough coins');};
document.getElementById('skinBtn').onclick=()=>{if(coins>=50){coins-=50;localStorage.setItem(LS_COINS,coins);updDisp();react(1.8,'New look!');}else alert('Not enough coins');};
document.getElementById('boostBtn').onclick=()=>{if(coins>=6){coins-=6;coins++;localStorage.setItem(LS_COINS,coins);updDisp();react(1.6,'Boosted!');}else alert('Not enough coins');};
function agg(){const m={};for(const s of sess){const d=new Date(s.startISO);if(!isNaN(d)){const k=d.toISOString().split('T')[0];m[k]=(m[k]||0)+s.secs;}}return m;}
function daysAgo(n){const d=new Date();d.setDate(d.getDate()-n);return d;}
function weekly(m){const l=[],dta=[];for(let i=6;i>=0;i--){const d=daysAgo(i),k=d.toISOString().split('T')[0];l.push(d.toLocaleDateString(undefined,{weekday:'short'}));dta.push(Math.round((m[k]||0)/60));}return{labels:l,data:dta};}
function monthly(m){const l=[],dta=[],n=new Date();for(let i=5;i>=0;i--){const d=new Date(n.getFullYear(),n.getMonth()-i,1);l.push(d.toLocaleDateString(undefined,{month:'short'}));let t=0;for(const k in m){const dt=new Date(k);if(dt.getMonth()===d.getMonth()&&dt.getFullYear()===d.getFullYear())t+=m[k];}dta.push(Math.round(t/60));}return{labels:l,data:dta};}
function yearly(m){const l=[],dta=[],n=new Date();for(let i=4;i>=0;i--){const y=n.getFullYear()-i;l.push(y);let t=0;for(const k in m){const dt=new Date(k);if(dt.getFullYear()===y)t+=m[k];}dta.push(Math.round(t/60));}return{labels:l,data:dta};}
let curPeriod='daily';const barCtx=document.getElementById('barChart').getContext('2d');let barChart=null;
function getBars(p){const m=agg();if(p==='daily'||p==='weekly')return weekly(m);if(p==='monthly')return monthly(m);return yearly(m);}
function drawChart(){try{const b=getBars(curPeriod);if(barChart)barChart.destroy();barChart=new Chart(barCtx,{type:'bar',data:{labels:b.labels,datasets:[{data:b.data,backgroundColor:'#8de0c7'}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});const w=weekly(agg()).data.reduce((a,b)=>a+b,0)/7;document.getElementById('weeklyAvg').textContent=w.toFixed(1)+' min';}catch(e){console.warn(e);}}
document.querySelectorAll('.tab').forEach(t=>t.onclick=()=>{document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');curPeriod=t.dataset.period;drawChart();});
function init(){coins=parseInt(localStorage.getItem(LS_COINS)||'0',10)||0;sess=JSON.parse(localStorage.getItem(LS_SESS)||'[]');updDisp();drawChart();}
init();
</script>
</body>
</html>
